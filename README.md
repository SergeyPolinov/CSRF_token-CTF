# Описание уязвимости
CSRF (Cross-Site Request Forgery) — это атака, при которой злоумышленник заставляет аутентифицированного пользователя выполнить нежелательные действия на веб-странице. При этом законный пользователь не знает об этом. CSRF-атака возможна, если веб-приложение не проверяет подлинность запроса, отправленного на сервер. Если браузер автоматически добавляет куки сессии при выполнении запроса, злоумышленник может подменить данные.

# Способы защиты
1. Использование CSRF-токенов
2. Проверка заголовков "Origin" и "Referer"
3. Ограничение методов запроса (GET-запрос не должен изменять данные)
4. Ограничение времени жизни сессий

# Запуск приложения
Для запуска необходимо запустить Docker и прописать в командной строке:

*docker-compose up --build*

# Описание уязвимости в реализованном приложении
В приложении реализована защита от CSRF с использованием токенов. Однако, CSRF-токен генерируется при входе в систему и не изменяется до завершения сессии. Это позволяет злоумышленнику получить токен и использовать его в атаке: поменять пароль админа на любой иной, залогиниться от его имени и получить флаг.

# POC-эксплоит для получения флага
После запуска приложения начинает свою работу чекер. Он авторизуется на странице логина (**http://web:5000/login**) как администратор ("admin/admin123"). Администратор хочет сменить свой пароль, поэтому чекер переходит на страницу смены пароля (**http://web:5000/change**) и при этом извлекает оттуда CSRF-токен (который не изменяется до завершения сессии). Затем чекер идёт на вредоносную страницу (**http://evil:5005/login**) - злоумышленник мог хитростью заставить администратора зайти туда - и автоматически выполняет POST-запрос на страницу смены пароля с заданным паролем (hacked123) и CSRF-токеном. Наконец, чекер заходит через страницу логина с новоустановленным паролем, и флаг отображается.

Пример логов чекера:

*Copy*

*Checker script started*

*Checking...*

*Starting check...*

*Opening login page: http://web:5000/login*

*Logged in as admin*

*CSRF Token: 13acb3deb0f514fa73d75148cd9d34af*

*Opening attacker page: http://evil:5005/login?csrf_token=13acb3deb0f514fa73d75148cd9d34af*

*Page loaded successfully*

*Re-opening login page: http://web:5000/login*

*CSRF exploit worked! ✅*

После того, как последняя строка будет иметь место, можно зайти на страницу логина (**http://web:5000/login**), выполнить вход ("admin/hacked123") и увидеть флаг.
